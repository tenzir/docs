import { Image } from 'astro:assets';

<a href={props.url}>{props.Name}</a> is a search and observability suite for
unstructured data. Tenzir can send events to {props.Name} and emulate and
{props.Name} Bulk API endpoint.

<Image src={props.image} alt="How to send and receive data"/>

When sending data to {props.Name}, Tenzir uses the <a
  href={props.bulkApiUrl}>Bulk API</a> and attempts to maximally batch events
for throughput, accumulating multiple events before shipping them within a
single API call. You can control batching behavior with the `max_content_length`
and `send_timeout` options.

For more details, see the documentation for the
[`to_opensearch`](../../tql2/operators/to_opensearch.md) operator.

Tenzir can also present an {props.Name}-compatible REST API via the
[`from_opensearch`](../../tql2/operators/from_opensearch.md) operator.

## Examples

### Send events to an {props.Name} index

Send an example event to the `main` index:

import { Code } from '@astrojs/starlight/components';

export const sendToMainIndex = `
from {event: "example"}
to "NAME://1.2.3.4:9200", action="create", index="main"
`;

<Code
  code={sendToMainIndex.replace("NAME", props.Name.toLowerCase())}
  lang="tql"
/>

Instead of treating the entire event as document to be indexed by {props.Name},
you can designate a nested record as document:

export const sendNestedRecord = `
from {category: "qux", doc_id: "XXX", event: {foo: "bar"}}
to "NAME://localhost:9200", id=doc_id, doc=event, action="update", index=category
`;

<Code
  code={sendNestedRecord.replace("NAME", props.Name.toLowerCase())}
  lang="tql"
/>

The above example updates the document with ID `XXX` with the contents from the
nested field `event`.

### Accept data by emulating {props.Name}

Tenzir can act as drop-in replacement for {props.Name} by accepting data via a
Bulk API endpoint. This allows you to point your <a
href={props.logstashUrl}>Logstash</a> or Beats instances to Tenzir instead.

export const emulate = `
from "NAME://localhost:9200"
publish "NAME"
`;

<Code
  code={emulate.replace(/NAME/g, props.Name.toLowerCase())}
  lang="tql"
/>

This pipeline accepts data on port 9200 and publishes all received events on the
<code>{props.Name.toLowerCase()}</code> topic for further processing by other
pipelines.

#### Ship data via Logstash

To send data to {props.Name} via <a href={props.logstashConfigUrl}>Logstash</a>,
use the standard Logstash configuration with the
<code>{props.Name.toLowerCase()}</code> output plugin. Here's an example of your
`pipeline.conf`:

export const shipViaLogstash = `
output {
  NAME {
    hosts       => "https://localhost:9200"
  }
}
`;

<Code
  code={shipViaLogstash.replace("NAME", props.Name.toLowerCase())}
  lang="javascript"
/>

When adapting an existing Logstash configuration, it suffices to exchange the
value of `hosts` with the endpoint of the corresponding Tenzir pipeline.

---
import { getCollection } from 'astro:content';
import GraduationCapIcon from '../icons/GraduationCapIcon.astro';
import { pathWithBase } from '@utils/base';

// Build lookup map for page titles
const allDocs = await getCollection('docs');
const docsMap = new Map(allDocs.map((entry) => [entry.id, entry]));

const path = Astro.slots.has('default')
  ? (await Astro.slots.render('default')).trim()
  : '';
const href = pathWithBase(`/tutorials/${path}`);

// Try to get actual page title, fall back to slug transformation
const entry = docsMap.get(`tutorials/${path}`);
const title = entry?.data.title ?? path
  .split('/')
  .pop()!
  .split('-')
  .map((word, i) => i === 0 ? word.charAt(0).toUpperCase() + word.slice(1) : word)
  .join(' ');
---

<span class="inline-icon-wrapper" data-tooltip="Tutorial"><GraduationCapIcon class="inline-icon" /></span><a href={href}>{title}</a>

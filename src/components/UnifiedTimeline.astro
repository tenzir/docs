---
import type { StarlightIcon } from "@astrojs/starlight/components/Icons";
/**
 * UnifiedTimeline component for the /changelog/timeline page.
 *
 * Displays all changelog entries from all projects in reverse-chronological
 * order, with a toggle to include/exclude unreleased entries.
 */
import Timeline from "./Timeline.astro";

interface TimelineEntry {
  version: string;
  date: string;
  href: string;
  description?: string;
  project?: {
    id: string;
    name: string;
    icon: StarlightIcon;
    color: string;
    parentName?: string;
  };
}

// Use import.meta.glob to gracefully handle missing generated file
const modules = import.meta.glob<{ unifiedTimelineEntries: TimelineEntry[] }>(
  "../unified-timeline-data.generated.ts",
  { eager: true },
);
const generated = Object.values(modules)[0];
const entries = generated?.unifiedTimelineEntries ?? [];
---

<unified-timeline-view>
  <Timeline entries={entries} showProjectInfo />
</unified-timeline-view>

<style>
  unified-timeline-view {
    display: block;
  }
</style>

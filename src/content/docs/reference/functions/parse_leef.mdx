---
title: parse_leef
category: Parsing
example: 'string.parse_leef()'
---

import Fn from '@components/see-also/Fn.astro';
import Op from '@components/see-also/Op.astro';
import Guide from '@components/see-also/Guide.astro';

Parses a string as a LEEF message

```tql
parse_leef(input:string, [schema=string, selector=string, schema_only=bool,
           raw=bool, unflatten_separator=string]) -> record
```

## Description

The `parse_leef` function parses a string as a LEEF message

### `input: string`

The string to parse.

import ParsingOptions from '@partials/functions/ParsingOptions.mdx';

<ParsingOptions />

## Examples

```tql
from { input: "LEEF:1.0|Microsoft|MSExchange|2016|15345|src=10.50.1.1	dst=2.10.20.20	spt=1200" }
output = input.parse_leef()
```

```tql
{
  input: "LEEF:1.0|Microsoft|MSExchange|2016|15345|src=10.50.1.1\tdst=2.10.20.20\tspt=1200",
  output: {
    leef_version: "1.0",
    vendor: "Microsoft",
    product_name: "MSExchange",
    product_version: "2016",
    event_class_id: "15345",
    attributes: {
      src: 10.50.1.1,
      dst: 2.10.20.20,
      spt: 1200,
    },
  },
}
```

## See Also

- <Fn>parse_cef</Fn>
- <Fn>print_leef</Fn>
- <Op>read_leef</Op>
- <Op>read_syslog</Op>
- <Op>write_syslog</Op>
- <Guide>data-shaping/extract-structured-data-from-text</Guide>

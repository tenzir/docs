---
title: from_file
category: Inputs/Events
example: 'from_file "s3://data/**.json"'
---

import Op from '@components/see-also/Op.astro';
import Guide from '@components/see-also/Guide.astro';
import Integration from '@components/see-also/Integration.astro';
import FromFileCommonParams from '@partials/operators/FromFileCommonParams.mdx';

Reads one or multiple files from a filesystem.

```tql
from_file url:string, [watch=bool, remove=bool, rename=string->string,
          path_field=field, max_age=duration] { â€¦ }
```

## Description

The `from_file` operator reads files from local filesystems or cloud storage,
with support for glob patterns, automatic format detection, and file
monitoring.

### `url: string`

URL or local filesystem path where data should be read from.

The characters `*` and `**` have a special meaning. `*` matches everything
except `/`. `**` matches everything including `/`. The sequence `/**/` can also
match nothing. For example, `foo/**/bar` matches `foo/bar`.

The URL can include additional options. For `s3://`, the options that can be
included in the URI as query parameters are `region`, `scheme`,
`endpoint_override`, `allow_bucket_creation`, and `allow_bucket_deletion`. For
`gs://`, the supported parameters are `scheme`, `endpoint_override`, and
`retry_limit_seconds`.

<FromFileCommonParams />

The pipeline uses the same logic as [`from`](/reference/operators/from).

## Examples

### Read every `.csv` file from S3

```tql
from_file "s3://my-bucket/**.csv"
```

### Read every `.json` file in `/data` as Suricata EVE JSON

```tql
from_file "/data/**.json" {
  read_suricata
}
```

### Read all files from S3 continuously and delete them afterwards

```tql
from_file "s3://my-bucket/**", watch=true, remove=true
```

### Move files to a directory, preserving filenames

```tql
// The trailing slash automatically appends the original filename
from_file "/input/*.json", rename=path => "/output/"
```

### Process only recently modified files

```tql
// Only process files modified in the last hour
from_file "/logs/*.json", max_age=1h
```

## See Also

- <Op>from</Op>
- <Op>load_file</Op>
- <Guide>enrichment/enrich-with-network-inventory</Guide>
- <Guide>enrichment/work-with-lookup-tables</Guide>
- <Guide>edge-storage/import-into-a-node</Guide>
- <Integration>file</Integration>

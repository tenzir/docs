---
title: SentinelOne Data Lake
---

[SentinelOne](https://www.sentinelone.com) is a cybersecurity platform that
provides endpoint protection and threat detection. The SentinelOne [Singularity
Data Lake](https://www.sentinelone.com/products/singularity-data-lake/) allows
you to store and analyze security events at scale. Tenzir can send structured
security events to the SentinelOne Data Lake via its REST API.

![SentinelOne Data Lake](sentinelone-data-lake.svg)

The operator provides special handling for OCSF events. If it detects that the
input event in OCSF, it will automatically map timestamp and severity fields to
the corresponding SentinelOne Data Lake fields.

## Examples

### Send events to SentinelOne Data Lake

To send events from a pipeline to SentinelOne Data Lake, use the
[`to_sentinelone_data_lake`](/reference/operators/to_sentinelone_data_lake)
operator:

```tql
subscribe "suricata"
where @name == "suricata.alert"
to_sentinelone_data_lake "https://ingest.eu1.sentinelone.net",
  bearer_token=secret("SENTINELONE_TOKEN")
```

Replace `https://ingest.eu1.sentinelone.net` with your conigured SentinelOne
Data Lake ingest URL and configure the `SENTINELONE_TOKEN` secret with your
bearer token.

### Send events with additional session information

You can include additional session information that identifies the source of the
events:

```tql
subscribe "network-events"
to_sentinelone_data_lake "https://ingest.eu1.sentinelone.net",
  bearer_token=secret("SENTINELONE_TOKEN"),
  session_info={
    serverHost: "Tenzir Node 01",
    serverType: "Tenzir Node",
    region: "US East"
  }
```

### Send OCSF events

If the datastream input is valid OCSF, the operator will automatically extract
timestamp and severity fields and map them to the corresponding SentinelOne Data
Lake fields `ts` and `sev`:

```tql
subscribe "ocsf"
where severity_id >= 4  // High and Critical events only
to_sentinelone_data_lake "https://ingest.eu1.sentinelone.net",
  bearer_token=secret("SENTINELONE_TOKEN"),
  session_info={serverHost: "Security Gateway"}
```

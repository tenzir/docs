---
title: OpenSearch
---

[OpenSearch](https://opensearch.org) is a search and observability suite for
unstructured data. Tenzir can send events to OpenSearch and emulate and
OpenSearch Bulk API endpoint.

![OpenSearch](opensearch.svg)

When sending data to OpenSearch, Tenzir uses the [Bulk
API](https://opensearch.org/docs/latest/api-reference/document-apis/bulk/)
and attempts to maximally batch events for throughput, accumulating multiple
events before shipping them within a single API call. You can control batching
behavior with the `max_content_length` and `send_timeout` options.

For more details, see the documentation for the
[`to_opensearch`](../../tql2/operators/to_opensearch.md) operator.

Tenzir can also present an OpenSearch-compatible REST API via the
[`from_opensearch`](../../tql2/operators/from_opensearch.md) operator.

## Examples

### Send events to an OpenSearch index

Send an example event to the `main` index:

```tql
from {event: "example"}
to "opensearch://1.2.3.4:9200", action="create", index="main"
```

Instead of treating the entire event as document to be indexed by OpenSearch,
you can designate a nested record as document:

```tql
from {category: "qux", doc_id: "XXX", event: {foo: "bar"}}
to "opensearch://localhost:9200", id=doc_id, doc=event, action="update", index=category
```

The above example updates the document with ID `XXX` with the contents from the
nested field `event`.

### Accept data by emulating OpenSearch

Tenzir can act as drop-in replacement for OpenSearch by accepting data via a
Bulk API endpoint. This allows you to point your
[Logstash](https://opensearch.org/docs/latest/tools/logstash/index/) or Beats
instances to Tenzir instead.

```tql
from "opensearch://localhost:9200"
publish "opensearch"
```

This pipeline accepts data on port 9200 and publishes all received events on the
`opensearch` topic for further processing by other pipelines.

#### Ship data via Logstash

To send data to the OpenSearch endpoint, use the standard Logstash configuration
with the OpenSearch output plugin. Here's an example of your
`pipeline.conf`:

```javascript
output {
  opensearch {
    hosts       => "https://localhost:9200"
    user        => "admin"
    password    => "admin"
    index       => "logstash-logs-%{+YYYY.MM.dd}"
    ssl_certificate_verification => false
  }
}
```

When adapting an existing Logstash configuration, it often suffices to just
exchange the endpoint, i.e., change `hosts` to the endpoint of the corresponding
Tenzir pipeline.

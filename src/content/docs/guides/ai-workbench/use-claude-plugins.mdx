---
title: Use Claude plugins
description: Install the Tenzir plugin to write TQL pipelines and navigate OCSF schemas
---

import { Tabs, TabItem, Steps } from '@astrojs/starlight/components';

This guide shows you how to install and use the `tenzir` plugin for Claude Code.
The plugin provides documentation for writing TQL pipelines and the `tenzir:ocsf`
subagent for OCSF schema questions.

## Install the plugin

<Tabs>
<TabItem label="Interactive" icon="laptop">

<Steps>
1. Run `/plugins` in Claude Code
2. Go to **Marketplaces**
3. Select **Add Marketplace**
4. Enter `tenzir/claude-plugins`
5. Install **tenzir** from the plugin list
</Steps>

</TabItem>
<TabItem label="Shell" icon="seti:shell">

```bash
# Add the Tenzir marketplace (once)
claude plugins marketplace add tenzir/claude-plugins

# Install the plugin
claude plugins install tenzir@tenzir
```

</TabItem>
</Tabs>

## Write TQL pipelines

The plugin loads TQL language fundamentals, operator references, and idiomatic
patterns on demand. Ask it to write pipelines and it will consult the
documentation to produce correct code.

<Tabs>
<TabItem label="Prompt" icon="pencil">

```
Write a TQL pipeline that reads Zeek TSV logs from a TCP socket, extracts the
connection 4-tuple, log ID, inbound/outbound bytes, and sends to Kafka.
```

</TabItem>
<TabItem label="Response" icon="document">

```tql
from "tcp://0.0.0.0:9999" {
  read_zeek_tsv
}
select \
  uid,
  src_ip=id.orig_h,
  src_port=id.orig_p,
  dst_ip=id.resp_h,
  dst_port=id.resp_p,
  orig_bytes,
  resp_bytes,
to_kafka "flows"
```

| Operator                    | Purpose                                                              |
| --------------------------- | -------------------------------------------------------------------- |
| `from "tcp://0.0.0.0:9999"` | Listens on TCP port 9999 for incoming connections                    |
| `{ read_zeek_tsv }`         | Per-connection pipeline that parses Zeek's tab-separated format      |
| `select`                    | Extracts only the requested fields, renaming the 4-tuple for clarity |
| `to_kafka "flows"`          | Publishes each event as JSON to the Kafka topic "flows"              |

</TabItem>
</Tabs>

## Navigate OCSF schemas

The `tenzir:ocsf` subagent answers questions about the [Open Cybersecurity
Schema Framework](https://schema.ocsf.io)â€”event classes, objects, attributes,
and profiles across multiple versions.

<Tabs>
<TabItem label="Prompt" icon="pencil">

```
@tenzir:ocsf What OCSF class should I use for firewall blocks?
```

</TabItem>
<TabItem label="Response" icon="document">

Use **Network Activity** (`class_uid`: **4001**).

Key attributes for firewall events:

- `action_id`: The action taken (allow, block, deny)
- `disposition_id`: The outcome (allowed, blocked)
- `firewall_rule`: The rule that triggered the action
- `src_endpoint` / `dst_endpoint`: Network endpoints
- `connection_info`: Protocol, ports, etc.

</TabItem>
</Tabs>

## Next steps

- Browse the [Claude Marketplace](https://github.com/tenzir/claude-plugins) for
  all available plugins

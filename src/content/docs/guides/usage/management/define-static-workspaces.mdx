---
title: Define static workspaces
---

Workspaces in the [platform](../../../../explanations/architecture/platform)
logically group nodes, secrets, and dashboards. You pre-define **static
workspaces** declaratively in configuration files. This "as-code" approach
differs from the dynamic management approach, which you manage with the [command
line interface](../use-the-platform-cli).

## Configure static workspaces

Here's a minimal example of a static workspace configuration:

```yaml title="workspaces.yaml"
workspaces:
  static0:                # Unique workspace identifier
    name: Tenzir          # Display name in the UI
    category: Statically Configured Workspaces  # Grouping category in the UI
    icon-url: https://storage.googleapis.com/tenzir-public-data/icons/tenzir-logo-square.svg
    auth-rules:
      - {"auth_fn": "auth_allow_all"}  # Authentication rule (this allows everyone)
```

The `auth-rules` section defines who can access the workspace. The example above
uses `auth_allow_all`. This rule grants access to everyone. Our [guide on
configuring shared workspaces](../configure-shared-workspaces) has more details
on auth rules.

:::tip[Generating Auth Rules]
Use the `print-auth-rule` [CLI](../../../../reference/platform-cli) command to
easily generate auth rules in the correct format:

```bash
tenzir-platform tools print-auth-rule allow-all
```
:::

The `platform` service in a Tenzir Platform deployment uses the
`WORKSPACE_CONFIG_FILE` environment variable to locate its static workspace
configuration file:

```yaml title="docker-compose.yaml"
services:
  platform:
    environment:
      # Other environment variables...
      - WORKSPACE_CONFIG_FILE=/etc/tenzir/workspaces.yaml
    volumes:
      # Mount your config file.
      - ./workspaces.yaml:/etc/tenzir/workspaces.yaml
```

This example mounts a local `workspaces.yaml` file into the container. The
platform service then accesses it at the location that
`WORKSPACE_CONFIG_FILE` specifies.

### Enable ephemeral nodes

An **ephemeral node** is ideal for temporary or auto-scaling deployments. It
is a temporary node that you do not have to provision manually first, and
it disappears from the workspace when the connection to the platform ends.

Using ephemeral nodes requires that you define a *workspace token*, a shared
secret that you pass to the node so that it can self-register. You can define a
workspace token in your workspace configuration:

```yaml title="workspaces.yaml"
workspaces:
  static0:
    name: Tenzir
    # Other configuration...
    token: wsk_e9ee76d4faf4b213745dd5c99a9be11f501d7009ded63f2d5NmDS38vXR
```

:::caution
Workspace tokens have a specific format. Do not create them manually!
Use the `tenzir-platform tools generate-workspace-token` command to create
valid tokens.
:::

For improved security, store the token in a separate file:

```yaml title="workspaces.yaml"
workspaces:
  static0:
    name: Tenzir
    # Other configuration...
    token-file: /run/secrets/workspace_token
```

This approach works well when you use Docker or Kubernetes secrets.

### Deploy an ephemeral node

To spawn an ephemeral node, create configuration file with the workspace token:

```yaml title="config.yaml"
tenzir:
  token: wsk_e9ee76d4faf4b213745dd5c99a9be11f501d7009ded63f2d5NmDS38vXR
  platform-control-endpoint: http://tenzir-platform.example.org:3001
```

Then run the node with this configuration:

```bash
tenzir-node --config=config.yaml
```

## Configure static dashboards

You can pre-define dashboards for your static workspaces. This practice
provides users with ready-to-use visualizations when they access the
workspace.

Use the `dashboards` key in your workspace configuration:

```yaml title="workspace.yaml"
workspaces:
  static0:
    name: Example Workspace
    # Other workspace configuration...
    dashboards:
      dashboard1:                # Unique dashboard identifier
        name: Example Dashboard  # Display name in the UI
        cells:                   # Dashboard cells/widgets
          - name: Partition Summary  # Cell name
            definition: |        # Pipeline to execute
              partitions
              where not internal
              summarize events=sum(events), schema
              sort -events
            type: table        # Visualization type (table, bar, line, etc.)
            x: 0               # X-coordinate in the dashboard grid
            y: 0               # Y-coordinate in the dashboard grid
            w: 12              # Width in grid units
            h: 12              # Height in grid units
```

:::note[Dashboard Coordinates]
The dashboard grid has a width of 24 units. When you position cells, ensure
that `x + w â‰¤ 24`. This prevents cells from extending beyond the grid.
:::

Users can modify these dashboards via the UI after their initial setup.
However, the platform resets any changes to the configuration-defined state
when it restarts.

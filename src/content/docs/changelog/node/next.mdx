---
title: Next
---

Unreleased changes.

### Changes

#### Reduced memory consumption during import

The memory usage while importing events has been significantly optimized.
Previously, importing would leave a trail of memory usage that only decreased
slowly over a period corresponding to `tenzir.active-partition-timeout`. Now,
events are properly released immediately after being written to disk, preventing
unnecessary memory accumulation.

We also eliminated redundant copies throughout the import path, reducing memory
usage by 2-4x depending on the dataset. Additionally, we optimized the memory
usage of buffered synopses, which are used internally when building indexes
during import. This optimization avoids unnecessary copies of strings and IP
addresses, roughly halving the memory consumption of the underlying component.

By [@jachris](https://github.com/jachris) in [#5532](https://github.com/tenzir/tenzir/pull/5532), [#5533](https://github.com/tenzir/tenzir/pull/5533), [#5535](https://github.com/tenzir/tenzir/pull/5535).

#### Dynamic clean up of expired keys in `deduplicate`

The `deduplicate` operator now also considers the timeouts set when calculating
frequency of cleaning up expired state. This resuts in lower memory usage if
a timeout is under `15min`.

By [@raxyte](https://github.com/raxyte) in [#5534](https://github.com/tenzir/tenzir/pull/5534).

#### Expose one-level recursion for OCSF objects

We now support recursive OCSF objects at depth one, as opposed to dropping
recursive objects entirely. For example, pipelines can safely follow
relationships such as `process.parent_process` or `analytic.related_analytics`:

```tql
from {
  metadata: {version: "1.5.0"},
  class_uid: 1007,
  process: {
    pid: 1234,
    parent_process: {
      pid: 5678,
    },
  },
}
ocsf::apply

// New!
assert process.parent_process.pid == 5678
assert not process.parent_process.has("parent_process")
```

The first assertion now succeeds while deeper ancestry is trimmed
automatically, preserving schema compatibility for downstream consumers.

By [@mavam](https://github.com/mavam) in [#5529](https://github.com/tenzir/tenzir/pull/5529).

---
title: Next
---

Unreleased changes.

### Features

#### Handling HTTP error status codes

The `from_http` and `http` operators now provide an `error_field` option that
lets you specify a field to receive the error response as a `blob`. When you set
this option, the operators keep events with status codes outside the 200–399
range so you can handle them manually.

By [@raxyte](https://github.com/raxyte) in [#5358](https://github.com/tenzir/tenzir/pull/5358).

#### Versioned sources in `to_amazon_security_lake` operator

The `to_amazon_security_lake` operator now supports versioned custom sources,
such as

```tql
let $lake_url = "s3://aws-security-data-lake-eu-west-2-lake-abcdefghijklmnopqrstuvwxyz1234/ext/tnz-ocsf-dns/1.0/"
to_amazon_security_lake $lake_url, …
```

By [@IyeOnline](https://github.com/IyeOnline) in [#5369](https://github.com/tenzir/tenzir/pull/5369).

#### Dropping null fields

The new `drop_null_fields` operator removes fields containing null values from
events. Without arguments, it drops all fields with null values. With field
arguments, it drops the specified fields if they contain null values, and for
record fields, it also recursively drops all null fields within them.

Drop all null fields:

```tql
from {
  id: 42,
  user: {name: "alice", email: null},
  status: null,
  tags: ["security", "audit"]
}
drop_null_fields
```

```tql
{
  id: 42,
  user: {
    name: "alice",
  },
  tags: [
    "security",
    "audit",
  ],
}
```

Drop specific null fields:

```tql
from {
  id: 42,
  user: {name: "alice", email: null},
  status: null,
  tags: ["security", "audit"]
}
drop_null_fields user.email
```

```tql
{
  id: 42,
  user: {
    name: "alice",
  },
  status: null,
  tags: [
    "security",
    "audit",
  ],
}
```

Note that `status` remains because it wasn't specified in the field list.

When specifying a record field, all null fields within it are removed:

```tql
from {
  user: {name: "alice", email: null, role: null},
  settings: {theme: "dark", notifications: null}
}
drop_null_fields user
```

```tql
{
  user: {
    name: "alice",
  },
  settings: {
    theme: "dark",
    notifications: null,
  },
}
```

The `user.email` and `user.role` fields are removed because they are null fields
within the specified `user` record. The `settings.notifications` field remains
because `settings` was not specified.

By [@mavam](https://github.com/mavam) in [#5370](https://github.com/tenzir/tenzir/pull/5370).

#### Dynamic `log_type` for `to_google_secops`

The `to_google_secops` operator now supports dynamic `log_type`s. You can set
the option to any expression evaluating to a string, e.g.:

```tql
from {type: "CUSTOM_DNS", text: "..."},
     {type: "BIND_DNS", text: "..."}
to_google_secops log_type=type, log_text=text, ...
```

By [@raxyte](https://github.com/raxyte) in [#5365](https://github.com/tenzir/tenzir/pull/5365).

#### New `read_all` operator

The `read_all` operator produces a single event for its entire input stream.

By [@jachris](https://github.com/jachris) in [#5368](https://github.com/tenzir/tenzir/pull/5368).

### Bug Fixes

#### Context operator metrics

The data flowing through the `context::` family of operators is no longer
counted as actual ingress and egress.

By [@jachris](https://github.com/jachris) in [#5383](https://github.com/tenzir/tenzir/pull/5383).

#### Fixed secrets in `headers` argument in `from_http`

We fixed a crash when using a secret in the `headers` argument of the `from_http`
operator.

By [@IyeOnline](https://github.com/IyeOnline) in [#5376](https://github.com/tenzir/tenzir/pull/5376).

#### Fixed issue with table creation in `to_clickhouse`

Multiple `to_clickhouse` operators can now attempt to create the same ClickHouse
table at the same time without an error.

By [@IyeOnline](https://github.com/IyeOnline) in [#5360](https://github.com/tenzir/tenzir/pull/5360).

#### Fixed `to_amazon_security_lake` partitioning

The `to_amazon_security_lake` incorrectly partitioned as `…/accountID=…`. It now
uses the correct `…/accountId=…`.

By [@IyeOnline](https://github.com/IyeOnline) in [#5369](https://github.com/tenzir/tenzir/pull/5369).

#### Return type of `map` for empty lists

Previously, the `map` function would return the input list when the input was
empty, possibly producing type warnings downstream. It now correctly returns
`list<null>` instead.

By [@jachris](https://github.com/jachris) in [#5385](https://github.com/tenzir/tenzir/pull/5385).

---
title: Next
---

Unreleased changes.

### Features

#### Receive UDP datagrams as events

The new `from_udp` operator receives UDP datagrams and outputs structured events
containing both the data and peer information.

Unlike `load_udp` which outputs raw bytes, `from_udp` produces events with
metadata about the sender, making it ideal for security monitoring and network
analysis where knowing the source of each datagram is important.

Each received datagram becomes an event with this structure:

```tql
from_udp "0.0.0.0:1234"
```

```tql
{
  data: "Hello, UDP!\n",
  peer: {
    ip: 192.168.1.100,
    port: 54321,
  },
}
```

Enable hostname resolution for DNS lookups (disabled by default for performance):

```tql
from_udp "0.0.0.0:1234", resolve_hostnames=true
```

```tql
{
  data: "Hello, UDP!\n",
  peer: {
    ip: 192.168.1.100,
    port: 54321,
    hostname: "client.example.com",
  },
}
```

By [@mavam](https://github.com/mavam) in [#5375](https://github.com/tenzir/tenzir/pull/5375).

#### Perform inline DNS lookups

The new `dns_lookup` operator enables DNS resolution for both IP addresses and
domain names. It performs reverse PTR lookups for IP addresses and forward
A/AAAA lookups for hostnames, returning structured results with hostnames or IP
addresses with their types and TTLs.

Resolve a domain name to IP addresses:

```tql
from {
  host: "example.com"
}
dns_lookup host
```

```tql
{
  host: "example.com",
  dns_lookup: {
    records: [
      {
        address: 2600:1406:3a00:21::173e:2e65,
        type: "AAAA",
        ttl: 58s,
      },
      {
        address: 23.215.0.136,
        type: "A",
        ttl: 2.433333333333333min,
      },
      // ... more records
    ],
  },
}
```

Resolve an IP address to a hostname:

```tql
from {
  ip: 8.8.8.8
}
dns_lookup ip
```

```tql
{
  ip: 8.8.8.8,
  dns_lookup: {
    hostname: "dns.google",
  },
}
```

By [@mavam](https://github.com/mavam), [@IyeOnline](https://github.com/IyeOnline) in [#5379](https://github.com/tenzir/tenzir/pull/5379).

#### `contains_null(x:any)`

We added a new `contains_null` function that checks if the input value contains any
`null` values.

By [@raxyte](https://github.com/raxyte) in [#5419](https://github.com/tenzir/tenzir/pull/5419).

### Changes

#### `every` and `cron` subpipelines

We changed the execution model for `every` and `cron` subpipelines, resulting
in:
- operators such as `context::load` now execute properly.
- subpipelines can contain both `remote` and `local` operators.
- subpipelines must not accept or output bytes.

By [@raxyte](https://github.com/raxyte) in [#5410](https://github.com/tenzir/tenzir/pull/5410).

#### Amazon Security Lake

We have made two convenience changes to the `to_amazon_security_lake` operator:

* The `role` parameter now defaults to the automatically generated role for the
  custom source in Security Lake. If you are using a different role, you can
  still specify it.
* The operator now uses UUIDv7 for the names of the files written into the
  Security Lake's blob storage. Since UUIDv7 is time ordered, inspecting the
  files in the lake becomes slightly easier.

By [@mavam](https://github.com/mavam), [@IyeOnline](https://github.com/IyeOnline) in [#5412](https://github.com/tenzir/tenzir/pull/5412).

### Bug Fixes

#### Rare crash in `save_tcp` operator

We fixed a rare shutdown crash in the `save_tcp` operator.

By [@jachris](https://github.com/jachris) in [#5420](https://github.com/tenzir/tenzir/pull/5420).
